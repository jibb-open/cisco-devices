import xapi from "xapi"
import { JIBB } from "./#JSSDKFileName#"
let JSSDKVersion = "#JSSDKVersion#"
let ApiKey = "YourApiKey"
let RecordingEmail = ""
let MeetingAPI = JIBB.Meeting
let Auth = JIBB.Auth
let EventBus = JIBB.EventBus
let Recording = JIBB.Recording
let ShareMeetingStatus = JIBB.ShareMeetingStatus

let recordingStartInFlight = false;

const MEETING_STATE = {
	NONE: "NONE",
	TEAMS: "TEAMS",
	WEBEX: "WEBEX",
};

const DEVICE_MODE = {
	WEBEX: "webex",
	MTR: "mtr",
};

let deviceMode = DEVICE_MODE.WEBEX;

const MEETING_PROVIDER = {
	WEBEX: "webex",
	TEAMS: "microsoft",
	UNKNOWN: "unknown",
};

const SurfaceType = {
	PAPER: "PAPER",
	WHITEBOARD: "WHITEBOARD",
}

function getHostname(url) {
	const match = url.match(/^(?:https?:\/\/)?(?:www\.)?([^\/:]+)/i);
	return match && match[1];
}

function Config(apiKey) {
	this.apiKey = apiKey
	this.webURL = "#WebAppUrl#"
	JIBB.Config.setApiBaseURL("#ApiUrl#")
	JIBB.Auth.configure({ apiKey })
}


let SessionDetails = {
	meetingId: "",
	meetingToken: "",
	userToken: "",
	meetingUrl: "",
	cameraId: "",
	clientId: "",
	selectedInput: 1,

	isJibbRunning: false,
	externalMeetingId: null,
	provider: null,
	isRecordingInProgress: false,
};

let CurrentDeviceCameraSettings = {
	SettingsCleared: true,
	PresenterTrack: false,
	SpeakerTrack: "null",
	Pan: 0,
	Tilt: 0,
	Zoom: 0,
}

function asBool(v) {
	return v === true || v === "True" || v === "true" || v === 1 || v === "1";
}

async function getTeamsInCall() {
	const v = await safe(() => xapi.Status.MicrosoftTeams.Calling.InCall.get(), "Teams.Calling.InCall");
	return asBool(v);
}

async function getMeetingState() {
	// Always check Teams first (safe even on non-MTR: it will return null/false)
	const inTeamsCall = await getTeamsInCall();
	if (inTeamsCall) return MEETING_STATE.TEAMS;

	// Then check RoomOS call stack
	const calls = await safe(() => xapi.Status.Call.get(), "Status.Call.get()");
	if (!Array.isArray(calls) || calls.length === 0) {
		return MEETING_STATE.NONE;
	}

	const call = calls[0];
	const provider = detectMeetingProviderFromCall(call);

	if (provider === MEETING_PROVIDER.TEAMS) return MEETING_STATE.TEAMS;
	if (provider === MEETING_PROVIDER.WEBEX) return MEETING_STATE.WEBEX;

	// If unknown provider but call exists, you can decide your default:
	return MEETING_STATE.WEBEX;
}



async function handleStandaloneRecordingFlow(title) {
	logIfRunning("[JIBB][NONE] standalone flow started");

	const ok = await ensureMeetingContextReady({ needUrl: false, timeoutMs: 25000 });
	if (!ok) return;

	try {
		const payload = {
			sensivityLevel: 2,
			meetingId: SessionDetails.meetingId,
			meetingToken: SessionDetails.meetingToken,
			title,
			// no alternativeEmail, no deviceSerialNumber
		};

		console.log("[JIBB][NONE][Rec] payload:", payload);

		await Recording.startRecording(payload);
		SessionDetails.isRecordingInProgress = true;
		logIfRunning("[JIBB][NONE] Recording started");
	} catch (err) {
		console.log("[JIBB][NONE] Recording Error:", err);
	}
}


async function waitUntil(predicate, timeoutMs = 20000, intervalMs = 250) {
	const start = Date.now();
	while (Date.now() - start < timeoutMs) {
		try {
			if (await predicate()) return true;
		} catch { }
		await sleep(intervalMs);
	}
	return false;
}

async function ensureMeetingContextReady({ needUrl = false, timeoutMs = 25000 } = {}) {
	// Wait for meetingId (autoStartMeeting sets it early)
	const hasMeetingId = await waitUntil(() => !!SessionDetails.meetingId, timeoutMs, 250);
	if (!hasMeetingId) {
		console.log("[JIBB] Meeting context not ready: missing meetingId");
		return false;
	}

	// If meetingToken isn't ready yet, try to fetch it here (race-safe)
	if (!SessionDetails.meetingToken) {
		try {
			await gettingMeetingToken();
		} catch (e) {
			console.log("[JIBB] gettingMeetingToken failed (will keep waiting):", e?.message || e);
		}
	}

	const hasMeetingToken = await waitUntil(() => !!SessionDetails.meetingToken, timeoutMs, 250);
	if (!hasMeetingToken) {
		console.log("[JIBB] Meeting context not ready: missing meetingToken");
		return false;
	}

	if (needUrl) {
		const hasUrl = await waitUntil(() => !!SessionDetails.meetingUrl, timeoutMs, 250);
		if (!hasUrl) {
			console.log("[JIBB] Meeting context not ready: missing meetingUrl (Teams share needs it)");
			return false;
		}
	}

	return true;
}

function registerTeamsCallHandlers() {
	// fires when Teams call starts/ends (works in MTR mode)
	try {
		xapi.Status.MicrosoftTeams.Calling.InCall.on(async (v) => {
			deviceMode = DEVICE_MODE.MTR; // Teams stack exists => this is MTR

			const inCall = asBool(v);
			console.log("[JIBB][Teams] InCall changed:", inCall);

			if (inCall) {
				if (!SessionDetails.isJibbRunning) return;

				// meeting connected start Teams flow (share+record)
				SessionDetails.provider = MEETING_PROVIDER.TEAMS;
				startRecording().catch(e => console.log("[JIBB] startRecording failed:", e?.message || e));
				return;
			}

			// call ended stop everything
			if (SessionDetails.isJibbRunning) {
				await stopMeeting();

				// update UI toggle
				try {
					await xapi.Command.UserInterface.Extensions.Widget.SetValue({
						WidgetId: "jibb_start_toggle",
						Value: "stop",
					});
				} catch { }
			}
		});
	} catch (e) {
		console.log("[JIBB][Teams] InCall path not available; skipping Teams handlers:", e?.message || e);
	}
}


function registerWebexCallHandlers() {
	xapi.Event.CallDisconnect.on(async () => {

		const wasRunning = SessionDetails.isJibbRunning;

		SessionDetails.externalMeetingId = null;
		SessionDetails.provider = null;


		if (!wasRunning) return;

		logIfRunning("Call disconnected > stopping JIBB...");

		try {
			await stopMeeting();


			try {
				await xapi.Command.UserInterface.Extensions.Widget.SetValue({
					WidgetId: "jibb_start_toggle",
					Value: "stop"
				});
			} catch (uiErr) {
				console.warn("Failed to update toggle UI:", uiErr.message);
			}

			SessionDetails.isJibbRunning = false;

		} catch (err) {
			console.warn("Error stopping JIBB after meeting ended:", err.message);
		}
	});

	xapi.Event.CallSuccessful.on(async () => {
		if (!SessionDetails.isJibbRunning) return;
		logIfRunning("New meeting connected.");

		if (SessionDetails.isRecordingInProgress) {
			logIfRunning("Recording is already in progress > nothing to do.");
			return;
		}

		const calls = await xapi.Status.Call.get();
		const call = calls?.[0];
		if (!call) return;

		// still useful for WEBEX host-email flow
		SessionDetails.provider = detectMeetingProviderFromCall(call);
		SessionDetails.externalMeetingId = await extractExternalMeetingId(call);

		logIfRunning("Provider:", SessionDetails.provider);
		logIfRunning("Meeting Identifier:", SessionDetails.externalMeetingId);

		logIfRunning("CallSuccessful > startRecording...");
		logRecordingContext("CallSuccessful before startRecording");

		startRecording().catch(e =>
			console.log("[JIBB] startRecording failed:", e?.message || e)
		);
	});

}

async function safe(fn, label = "") {
	try {
		return await fn();
	} catch (err) {
		console.log(`Error in ${label}:`, err.message);
		return null;
	}
}

function convertSipToWebLink(sip) {
	const match = sip.match(/^([^@]+)@([^@]+\.webex\.com)$/i);
	if (!match) return null;

	let username = match[1];
	const domain = match[2];

	if (username.startsWith("spark:")) {
		username = username.replace("spark:", "");
	}

	return `https://${domain}/meet/${username}`;
}

function detectMeetingProviderFromCall(call) {
	const name = call.DisplayName || "";
	const cb = call.CallbackNumber || "";
	const proto = call.Protocol || "";

	if (/teams\.microsoft\.com/i.test(cb)) return MEETING_PROVIDER.TEAMS;
	if (/Teams Meeting/i.test(name)) return MEETING_PROVIDER.TEAMS;
	if (/WebRTC/i.test(proto) && /teams/i.test(cb)) return MEETING_PROVIDER.TEAMS;

	if (/\.webex\.com/i.test(cb)) return MEETING_PROVIDER.WEBEX;
	if (/spark:/i.test(cb)) return MEETING_PROVIDER.WEBEX;
	if (/Spark/i.test(proto)) return MEETING_PROVIDER.WEBEX;

	return MEETING_PROVIDER.UNKNOWN;
}


async function getHostEmail(orgId, meetingIdentifier) {
	let qs = [];

	if (meetingIdentifier.meetingNumber)
		qs.push(`webex_meeting_number=${meetingIdentifier.meetingNumber}`);

	if (meetingIdentifier.webLink)
		qs.push(`web_link=${encodeURIComponent(meetingIdentifier.webLink)}`);

	if (qs.length === 0) {
		console.log("No meetingNumber or webLink > skipping getHostEmail");
		return null;
	}

	const queryString = qs.join("&");
	const url = `#ApiUrl#/v1/webex-integration/${orgId}/host?${queryString}`;


	try {
		const response = await xapi.Command.HttpClient.Get({
			Url: url,
			Header: [`x-jibb-user-jwt: ${SessionDetails.userToken}`],
			ResultBody: "PlainText"
		});

		const data = JSON.parse(response.Body || "{}");
		return data.email || null;

	} catch (err) {
		console.log("Failed to fetch host email:", err.message);
		return null;
	}
}

async function extractExternalMeetingId(call) {
	const cb = call.CallbackNumber || "";


	try {
		const meetingNumber = await xapi.Status.Conference.MeetingNumber.get();
		if (meetingNumber && /^\d{9,12}$/.test(meetingNumber)) {
			return { meetingNumber: meetingNumber.trim(), webLink: null };
		}
	} catch { }

	try {
		const pmrUrl = await xapi.Status.Conference.PersonalMeeting.PersonalMeetingURL.get();
		if (pmrUrl && pmrUrl.startsWith("https://")) {
			return { meetingNumber: null, webLink: pmrUrl.trim() };
		}
	} catch { }


	const urlMatch = cb.match(/https:\/\/[^\s]+/i);
	if (urlMatch) {
		return { meetingNumber: null, webLink: urlMatch[0] };
	}


	const numMatch = cb.match(/\b\d{9,12}\b/);
	if (numMatch) {
		return { meetingNumber: numMatch[0], webLink: null };
	}


	const sipMatch = cb.match(/^[^@]+@[^@]+webex\.com$/i);
	if (sipMatch) {
		const webLink = convertSipToWebLink(sipMatch[0]);

		if (webLink) {
			return { meetingNumber: null, webLink };
		}
	}


	return { meetingNumber: null, webLink: null };
}


async function getJibbOrganizationId() {
	try {
		const info = await Auth.getUserClaims();

		if (info.organizationId) {
			return info.organizationId;
		}

		if (info.claims?.data?.organization_id) {
			return info.claims.data.organization_id;
		}
	} catch (e) {
		console.log("Cannot get organizationId:", e.message);
	}
	return null;
}

async function getMeetingProviderAndId() {
	const calls = await xapi.Status.Call.get();
	console.log("[JIBB][DBG] Status.Call.get():", JSON.stringify(calls || [], null, 2));

	if (!calls || calls.length === 0) return null;

	const call = calls[0];
	const provider = detectMeetingProviderFromCall(call);
	const idObj = await extractExternalMeetingId(call);

	return { provider, meetingIdentifier: idObj };
}


async function getDeviceSerialNumber() {
	// Best practical identifier on RoomOS (serial)
	try {
		const sn = await xapi.Status.SystemUnit.Hardware.Module.SerialNumber.get();
		const v = String(sn || "").trim();
		if (!v) {
			console.log("[JIBB][Teams] device serial is empty");
			return null;
		}
		return v;
	} catch (e) {
		console.log("[JIBB][Teams] failed to get SerialNumber:", e?.message || e);
		return null;
	}
}

async function shareTeamsMeetingToChat(deviceSerialNumber) {
	const orgId = await getJibbOrganizationId();
	if (!orgId) throw new Error("Missing organizationId");

	if (!deviceSerialNumber) throw new Error("Missing device_serial_number");
	if (!SessionDetails.meetingId) throw new Error("Missing meetingId");

	const shareId = await MeetingAPI.createTemporaryShare({
		meetingId: SessionDetails.meetingId,
		permission: 13,
	});
	if (!shareId) throw new Error("can not create Share Id");

	const meetingUrl = `${config.webURL}/workspace/${SessionDetails.meetingId}/${shareId}`;
	if (!meetingUrl) throw new Error("Missing meeting_url");

	const url = `#ApiUrl#/v1/microsoft-integration/${orgId}/meeting/share`;

	const payloadStr = JSON.stringify({
		meeting_url: meetingUrl,
		device_serial_number: deviceSerialNumber,
	});

	console.log("[JIBB][Teams] POST", url);
	console.log("[JIBB][Teams] Body JSON:", payloadStr);

	const notify = async (text, durationSeconds = 15) => {
		try {
			await xapi.Command.Audio.Sound.Play({ Sound: "Announcement" });
		} catch (soundErr) {
			console.log("[JIBB][Teams] Audio.Sound.Play failed/unsupported:", soundErr?.message || soundErr);
		}

		try {
			await xapi.Command.UserInterface.Message.Alert.Display({
				Title: "JIBB",
				Text: text,
				Duration: durationSeconds,
			});
		} catch (uiErr) {
			console.log("[JIBB][Teams] Alert.Display failed:", uiErr?.message || uiErr);
		}
	};

	const res = await xapi.Command.HttpClient.Post(
		{
			Url: url,
			Header: [
				"Content-Type: application/json",
				`x-jibb-user-jwt: ${SessionDetails.userToken}`,
			],
			ResultBody: "PlainText",
		},
		payloadStr
	);

	console.log("[JIBB][Teams] Response:", res);

	if (String(res?.StatusCode) !== "200") {
		throw new Error(`meeting/share failed. StatusCode=${res?.StatusCode}`);
	}

	let bodyJson = null;
	try {
		bodyJson = res?.Body ? JSON.parse(res.Body) : null;
	} catch (parseErr) {
		console.log("[JIBB][Teams] Response body is not JSON:", parseErr?.message || parseErr);
	}

	const status = bodyJson?.status ?? bodyJson?.Status;

	switch (JIBB.normalizeShareMeetingStatus(status)) {
		case ShareMeetingStatus.PENDING_BOT:
			await notify(
				"Add JIBB to this meeting: in Microsoft Teams on your (phone/laptop), click Apps in the meeting toolbar (or More (...) Apps), search JIBB, then click Add.",
				60
			);
			return false;

		case ShareMeetingStatus.CURRENT_MEETING_NOT_FOUND:
		case 3:
			await notify(
				"This meeting is not scheduled, so the JIBB app ca not share the JIBB meeting in the chat box",
				15
			);
			return false;

		case ShareMeetingStatus.MICROSOFT_TEAM_NOT_CONNECTED:
		case 4:
			await notify(
				"Something went wrong, so JIBB app ca not share the JIBB meeting in the chat box",
				15
			);
			return false;

		default:
			return true;
	}
}


const checkSystemHealth = async (url) => {
	try {
		const res = await xapi.Command.HttpClient.Get({ ResultBody: 'None', Url: url });
		if (res.StatusCode == 200) {
			console.log(`You have access to ${url}`);
		} else {
			throw new Error(`Unexpected status code: ${res.StatusCode}`);
		}
	} catch (error) {
		console.log(error)
		console.log(`You do not have access to ${url}. Error: ${error}`);
		throw new Error(`You do not have access to JIBB APIs. Error: ${error.message}`);
	}

	try {
		const webEngineMode = await xapi.Config.WebEngine.Mode.get();
		if (webEngineMode !== "On") {
			throw new Error('WebEngine is off');
		}

		const httpClientMode = await xapi.Config.HttpClient.Mode.get();
		if (httpClientMode !== "On") {
			throw new Error('HttpClient is off');
		}
	} catch (error) {
		console.log(error)
		console.log(`You do not have access to device configuration: ${error}`);
		throw new Error(`Device configuration error: ${error.message}`);
	}
};

const getDeviceConfig = async () => {
	let DeviceInfo = {}
	let value = await xapi.Status.SystemUnit.Software.DisplayName.get()
	DeviceInfo.OS = value
	value = await xapi.Status.SystemUnit.ProductId.get()
	DeviceInfo.DeviceType = value

	DeviceInfo.ApiKey = ApiKey
	DeviceInfo.JIBBURI = "#ApiUrl#"
	DeviceInfo.JSSDKVersion = JSSDKVersion

	console.log("*** Device INFO ***")
	console.log(DeviceInfo)
	console.log("*** Device INFO ***")
}

async function generateMeetingLink() {
	console.log("generating meeting link ...")
	let title = await createTitle()
	await gettingUserToken()
	await createMeeting(title)
	SessionDetails.meetingUrl = `${config.webURL}/cisco/devices/${SessionDetails.meetingId}?user_token=${SessionDetails.userToken}`
}

async function createTitle() {
	let title = String(await xapi.Config.SystemUnit.CustomDeviceId.get())
	if (String(title) == "") {
		title = "JIBB Workspace"
	}
	return title
}

async function gettingUserToken() {
	try {
		SessionDetails.userToken = await Auth.getUserToken()
	} catch (err) {
		console.log(`Cannot get user token: ${err}`)
		xapi.Command.UserInterface.Message.Alert.Display({
			Duration: 20,
			Text: "Something went wrong. Please check your API KEY",
			Title: "Error",
		})
		throw ("Cannot get user token. Please check your API KEY")
	}
}

async function gettingMeetingToken() {
	SessionDetails.meetingToken = await MeetingAPI.getMeetingToken({
		meetingId: SessionDetails.meetingId,
		permission: 2,
	})
}

async function createMeeting(title) {
	SessionDetails.meetingId = await MeetingAPI.createMeeting({ title: title, isTemporary: true })
}

async function autoStartMeeting() {
	console.log("autoStartMeeting ...")
	hideJibbPanel()
	hideCameraSelfView()
	await generateMeetingLink()
	await openMeetingUrlInWebView()

	try {
		await getWebClinetId()
		await sleep(3000)
		await safe(getCameraId, "getCameraId");


	} catch (err) {
		console.log(err)
		console.error("Client or camera setup failed:", err.message)
		xapi.Command.UserInterface.Message.Alert.Display({
			Duration: 10,
			Text: "Please contact admin to check device settings",
			Title: "Setup Error",
		});
		return;
	}

	await gettingMeetingToken()
	await startTheMeeting()
	await sleep(5000)

	startRecording().catch(e =>
		console.log("[JIBB] startRecording failed:", e?.message || e)
	);

}


async function startTheMeeting() {
	let req = {
		meetingToken: SessionDetails.meetingToken,
		surfaceType: SurfaceType.WHITEBOARD,
		fixedCorners: true,
		cameraId: SessionDetails.cameraId,
		clientId: SessionDetails.clientId,
		enableColor: true,
	}
	await EventBus.startStream(req)
}


async function getCameraId() {
	try {
		const cameraList = await EventBus.getCameraList(SessionDetails.clientId);
		console.log("Raw camera list received from EventBus.getCameraList():", cameraList);

		if (!Array.isArray(cameraList) || cameraList.length === 0) {
			console.warn("Camera list is empty or not an array.");
			return Promise.reject("No cameras detected or accessible.");
		}

		const validCameras = cameraList.filter(cam => cam?.id?.trim());
		const invalidCameras = cameraList.filter(cam => !cam?.id?.trim());

		validCameras.forEach((cam, i) => {
			console.log(`  [${i + 1}] ID: ${cam.id}, Name: ${cam.name || "N/A"}`);
		});

		if (invalidCameras.length > 0) {
			invalidCameras.forEach((cam, index) => {
				console.warn(`  [${index + 1}] Camera object is invalid or missing 'id':`, cam);
			});
		}

		if (validCameras.length === 0) {
			return Promise.reject("No valid camera ID available.");
		}

		SessionDetails.cameraId = validCameras[0].id;
	} catch (err) {
		console.warn("Error in getCameraId:", err.message);
		return Promise.reject("Camera detection failed: " + err.message);
	}
}

async function getWebClinetId() {
	const maxAttempts = 60;      // up to 60s
	const retryDelayMs = 1000;

	for (let attempt = 1; attempt <= maxAttempts; attempt++) {
		console.log(`[getWebClinetId] attempt ${attempt}/${maxAttempts}`);

		const statusList = await EventBus.getClientStatusList();
		console.log("Full statusList from getClientStatusList():", statusList);

		// normalize possible shapes
		const items = Array.isArray(statusList) ? statusList : (statusList ? [statusList] : []);

		//  prefer WEBAPP client if present
		const webapp = items.find(c =>
			(c?.clientType === "WEBAPP" || c?.type === "WEBAPP") && c?.id
		);

		if (webapp?.id) {
			SessionDetails.clientId = webapp.id;
			return;
		}

		// fallback: any id
		const any = items.find(c => c?.id);
		if (any?.id) {
			SessionDetails.clientId = any.id;
			return;
		}

		await sleep(retryDelayMs);
	}

	console.error("No valid client ID found in status list after retries");
	throw new Error("Unable to get a valid client ID");
}



async function openMeetingUrlInWebView() {
	await xapi.Command.UserInterface.WebView.Display({ Title: "jibb", Url: SessionDetails.meetingUrl });

	//  IMPORTANT: wait until WebView is actually loaded, otherwise client list can stay empty
	await waitForWebViewReady(SessionDetails.meetingUrl, 30000);
}


async function stopMeeting() {
	logIfRunning("stopMeeting...");

	try {
		await stopRecording();
	} catch (err) {
		console.log(err)
		console.warn("Error stopping recording:", err.message);
	}

	try {
		await closeWebView();
	} catch (err) {
		console.log(err)
		console.warn("Error closing WebView:", err.message);
	}

	try {
		await hideCameraSelfView();
	} catch (err) {
		console.log(err)
		console.warn("Error hiding self-view:", err.message);
	}

	try {
		await hideJibbPanel();
	} catch (err) {
		console.log(err)
		console.warn("Error hiding JIBB panel:", err.message);
	}

	try {
		await setDeviceCameraToBeforeSettings();
	} catch (err) {
		console.log(err)
		console.warn("Error restoring camera settings:", err.message);
	}
	SessionDetails.isRecordingInProgress = false;
	SessionDetails.isJibbRunning = false;

	SessionDetails.meetingId = "";
	SessionDetails.meetingToken = "";
	SessionDetails.meetingUrl = "";
	SessionDetails.cameraId = "";
	SessionDetails.clientId = "";
	SessionDetails.externalMeetingId = null;
	SessionDetails.provider = null;

	logRecordingContext("stopMeeting completed");
}

async function handleWebexRecordingFlow(title) {
	logIfRunning("[JIBB][Webex] recording flow started");

	let recordingTargetEmail = RecordingEmail;
	if (recordingTargetEmail) {
		logIfRunning("[JIBB][Webex] Using RecordingEmail:", recordingTargetEmail);
	} else {
		logIfRunning("[JIBB][Webex] -> Host Email lookup...");

		const idObj = SessionDetails.externalMeetingId;
		if (!idObj || (!idObj.meetingNumber && !idObj.webLink)) {
			logIfRunning("[JIBB][Webex] No meetingNumber/webLink -> abort");
			return;
		}

		const orgId = await getJibbOrganizationId();
		const hostEmail = await getHostEmail(orgId, idObj);

		if (!hostEmail) {
			logIfRunning("[JIBB][Webex] Host email not found -> abort");
			return;
		}

		logIfRunning("[JIBB][Webex] Using host email:", hostEmail);
		recordingTargetEmail = hostEmail;
	}

	try {
		const payload = {
			sensivityLevel: 2,
			meetingId: SessionDetails.meetingId,
			meetingToken: SessionDetails.meetingToken,
			title,
			alternativeEmail: recordingTargetEmail
		};

		console.log("[JIBB][Webex][Rec] payload:", payload);

		await Recording.startRecording(payload);

		SessionDetails.isRecordingInProgress = true;
		logIfRunning("[JIBB][Webex] Recording started");
	} catch (err) {
		console.log("[JIBB][Webex] Recording Error:", err);
	}
}


async function handleTeamsRecordingFlow(title) {
	logIfRunning("[JIBB][Teams] flow started");

	// 1) Teams -> get device id
	const deviceSerialNumber = await getDeviceSerialNumber();
	if (!deviceSerialNumber) {
		console.log("[JIBB][Teams] Missing device serial -> abort");
		return;
	}

	// 2) Teams -> ensure meeting is ready (meetingId/meetingToken + meetingUrl for sharing)
	const ok = await ensureMeetingContextReady({ needUrl: true, timeoutMs: 25000 });
	if (!ok) return;

	// 3) Teams -> share meeting
	try {
		await shareTeamsMeetingToChat(deviceSerialNumber);
		logIfRunning("[JIBB][Teams] meeting/share OK (200)");
	} catch (err) {
		console.log("[JIBB][Teams] meeting/share failed:", err?.message || err);
		return;
	}

	// 4) Teams -> start recording
	try {
		const payload = {
			sensivityLevel: 2,
			meetingId: SessionDetails.meetingId,
			meetingToken: SessionDetails.meetingToken,
			title,
			deviceSerialNumber,
		};

		console.log("[JIBB][Webex][Teams] payload:", payload);

		await Recording.startRecording(payload);

		SessionDetails.isRecordingInProgress = true;
		logIfRunning("[JIBB][Teams] Recording started");
	} catch (err) {
		console.log("[JIBB][Teams] Recording Error:", err);
	}
}


function logRecordingContext(tag = "") {
	console.log(`[JIBB][CTX] ${tag}`, {
		isJibbRunning: SessionDetails.isJibbRunning,
		provider: SessionDetails.provider,
		externalMeetingId: SessionDetails.externalMeetingId,
		meetingId: SessionDetails.meetingId,
		hasMeetingToken: !!SessionDetails.meetingToken,
		hasUserToken: !!SessionDetails.userToken,
		hasMeetingUrl: !!SessionDetails.meetingUrl,
		isRecordingInProgress: SessionDetails.isRecordingInProgress,
	});
}

function isNoMatch(err) {
	const msg = String(err?.message || err || "");
	return /No match on Path argument/i.test(msg);
}

async function hasPath(getter, label = "") {
	try {
		await getter();
		return true;
	} catch (e) {
		if (!isNoMatch(e)) {
			console.log(`[JIBB] hasPath unexpected error (${label}):`, e?.message || e);
		}
		return false;
	}
}


async function startRecording() {
	if (SessionDetails.isRecordingInProgress || recordingStartInFlight) return;
	recordingStartInFlight = true;

	try {
		const title = await createTitle();

		if (!SessionDetails.userToken) {
			SessionDetails.userToken = await Auth.getUserToken();
		}

		const state = await getMeetingState();
		console.log("[JIBB] MeetingState:", state);

		if (state === MEETING_STATE.TEAMS) {
			await handleTeamsRecordingFlow(title);
			return;
		}

		if (state === MEETING_STATE.WEBEX) {
			const ok = await ensureMeetingContextReady({ needUrl: false, timeoutMs: 25000 });
			if (!ok) return;

			// Only needed for WEBEX host-email lookup
			if (!SessionDetails.externalMeetingId) {
				const ci = await safe(getMeetingProviderAndId, "getMeetingProviderAndId (webex)");
				if (ci?.meetingIdentifier) SessionDetails.externalMeetingId = ci.meetingIdentifier;
			}

			await handleWebexRecordingFlow(title);
			return;
		}

		// NONE
		await handleStandaloneRecordingFlow(title);

	} finally {
		recordingStartInFlight = false;
	}
}



async function stopRecording() {
	try {
		await Recording.stopRecording();
	} catch (err) {
		console.warn("Cannot stop recording");
	}

	SessionDetails.isRecordingInProgress = false;
}

async function setCameraPreset(positionName) {
	if (CurrentDeviceCameraSettings.SettingsCleared) {
		await getDeviceCurrentCameraSettings();
	}

	try {
		await xapi.Config.Cameras.PresenterTrack.Enabled.set(false);
	} catch (err) {
		console.warn("This device does not have PresenterTrack");
	}

	try {
		await xapi.Command.Cameras.SpeakerTrack.Deactivate();
	} catch (err) {
		console.warn("This device does not have SpeakerTrack");
	}

	const presetNamesToTry = [positionName, "Jibb", "jibb"];

	try {
		const allCameras = await xapi.Status.Cameras.Camera.get();
		console.log("All hardware cameras from xapi.Status.Cameras.Camera.get():", allCameras);

		if (!Array.isArray(allCameras) || allCameras.length === 0) {
			console.warn("No cameras available for preset lookup");
			return;
		}

		for (const cam of allCameras) {
			const camId = cam.id;
			try {
				const { Preset: presets = [] } = await xapi.Command.Camera.Preset.List({
					CameraId: camId,
					DefaultPosition: false
				});

				console.log(`Presets for camera ${camId}:`, presets);

				for (const name of presetNamesToTry) {
					const match = presets.find(preset =>
						preset.Name === name && (!preset.CameraId || preset.CameraId === camId)
					);

					if (match) {
						console.log(`Activating preset '${name}' (ID: ${match.PresetId}) on CameraId: ${camId}`);
						await xapi.Command.Camera.Preset.Activate({ PresetId: match.PresetId });
						return;
					}
				}
			} catch (err) {
				console.warn(`Error while listing presets for camera ${camId}:`, err.message);
			}
		}
	} catch (err) {
		console.warn("Preset activation failed due to camera or preset listing error:", err.message);
	}

	console.warn("No usable preset found on any available camera. Skipping camera position restore.");
}

async function setCameraPosition(positionName) {
	return setCameraPreset(positionName);
}


async function getDeviceCurrentCameraSettings() {
	console.log("getDeviceCurrentCameraSettings");
	try {
		CurrentDeviceCameraSettings.PresenterTrack = await xapi.Config.Cameras.PresenterTrack.Enabled.get();
	} catch (err) {
		console.log(err)
		console.warn("PresenterTrack not available:", err.message);
	}

	try {
		CurrentDeviceCameraSettings.SpeakerTrack = await xapi.Status.Cameras.SpeakerTrack.Status.get();
	} catch (err) {
		console.log(err)
		console.warn("SpeakerTrack not available:", err.message);
	}

	try {
		const cameras = await xapi.Status.Cameras.Camera.get();
		console.log("Cameras found in getDeviceCurrentCameraSettings:", cameras);
		if (Array.isArray(cameras) && cameras.length > 0) {
			const cam = cameras[0];
			CurrentDeviceCameraSettings.Pan = cam.Position?.Pan || 0;
			CurrentDeviceCameraSettings.Tilt = cam.Position?.Tilt || 0;
			CurrentDeviceCameraSettings.Zoom = cam.Position?.Zoom || 0;
		} else {
			console.warn("No camera data found for position.");
		}
	} catch (err) {
		console.log(err)
		console.warn("Error retrieving camera position:", err.message);
	}

	CurrentDeviceCameraSettings.SettingsCleared = false;
}


async function setDeviceCameraToBeforeSettings() {
	console.log("setDeviceCameraToBeforeSettings");

	try {
		if (CurrentDeviceCameraSettings.PresenterTrack) {
			await xapi.Config.Cameras.PresenterTrack.Enabled.set(true);
		}
	} catch (err) {
		console.log(err)
		console.warn("PresenterTrack not supported or failed to re-enable:", err.message);
	}

	try {
		if (CurrentDeviceCameraSettings.SpeakerTrack === "Active") {
			await xapi.Command.Cameras.SpeakerTrack.Activate();
		}
	} catch (err) {
		console.log(err)
		console.warn("SpeakerTrack not supported or failed to re-activate:", err.message);
	}

	try {
		const cameras = await xapi.Status.Cameras.Camera.get();

		if (Array.isArray(cameras) && cameras.length > 0) {
			const cameraId = cameras[0].id || 1;
			await xapi.Command.Camera.PositionSet({
				CameraId: cameraId,
				Pan: CurrentDeviceCameraSettings.Pan,
				Tilt: CurrentDeviceCameraSettings.Tilt,
				Zoom: CurrentDeviceCameraSettings.Zoom,
			});
		} else {
			console.warn("No physical cameras found to reset position.");
		}
	} catch (err) {
		console.log(err)
		console.warn("Camera PositionSet failed or not supported:", err.message);
	}

	clearCurrentDeviceCameraSettings();
}

function clearCurrentDeviceCameraSettings() {
	CurrentDeviceCameraSettings.SettingsCleared = true
	CurrentDeviceCameraSettings.PresenterTrack = false
	CurrentDeviceCameraSettings.SpeakerTrack = "null"
	CurrentDeviceCameraSettings.Pan = 0
	CurrentDeviceCameraSettings.Tilt = 0
	CurrentDeviceCameraSettings.Zoom = 0
}

function closeWebView() {
	return xapi.Command.UserInterface.WebView.Clear({ Target: "OSD" });
}

async function hideCameraSelfView() {
	try {
		return await xapi.Command.Video.Selfview.Set({
			FullscreenMode: "Off",
			Mode: "Off",
			PIPPosition: "LowerRight",
		});
	} catch (e) {
		console.log("[JIBB] Selfview not available:", e?.message || e);
		return null;
	}
}

async function showCameraSelfView() {
	try {
		await xapi.Command.Video.Selfview.Set({
			FullscreenMode: "Off",
			Mode: "On",
			PIPPosition: "LowerRight",
		});
	} catch (e) {
		console.log("[JIBB] Selfview.Set failed:", e?.message || e);
	}
}


function hideJibbPanel() {
	return xapi.Command.UserInterface.Extensions.Panel.Close();
}



function sleep(ms) {
	return new Promise((resolve) => setTimeout(resolve, ms))
}

function showAlert() {
	xapi.Command.UserInterface.Message.Alert.Display({
		Duration: 3,
		Text: "JIBB Ready",
		Title: "JIBB is Ready",
	})
}
function bindWidgetActions() {
	xapi.Event.UserInterface.Extensions.Widget.Action.on(async (event) => {
		if (!["changed", "released", "clicked"].includes(event.Type)) return;

		if (event.WidgetId === "jibb_start_toggle") {
			if (event.Value === "start") {
				if (SessionDetails.isJibbRunning || SessionDetails.isRecordingInProgress || SessionDetails.meetingId) {
					await stopMeeting()
				}
				SessionDetails.isJibbRunning = true;

				await xapi.Command.UserInterface.Extensions.Widget.SetValue({
					WidgetId: "jibb_start_toggle",
					Value: "start"
				});

				await autoStartMeeting()
			}

			if (event.Value === "stop") {
				SessionDetails.isJibbRunning = false;

				await xapi.Command.UserInterface.Extensions.Widget.SetValue({
					WidgetId: "jibb_start_toggle",
					Value: "stop"
				});

				RecordingEmail = "";
				await stopMeeting();
			}
			return;
		}

	});
}

let config = new Config(ApiKey)

async function addPanel() {
	const xml = uiExtension;

	await xapi.Command.UserInterface.Extensions.Panel.Save({ PanelId: "jibb_panel" }, xml);

	try {
		await sleep(400);
		await xapi.Command.UserInterface.Extensions.Widget.SetValue({
			WidgetId: "jibb_start_toggle",
			Value: "start",
		});
	} catch (e) {
		console.log("[JIBB] Toggle not ready yet:", e?.message || e);
	}
}

async function waitForSystemReady({ timeoutMs = 60000, pollMs = 1000 } = {}) {
	const start = Date.now();
	while (Date.now() - start < timeoutMs) {
		try {
			const s = await xapi.Status.SystemUnit.State.System.get(); // "Initializing" / "Initialized" / ...
			if (s === "Initialized") return true;
			console.log("[JIBB] System state:", s, "(waiting)");
		} catch (e) {
			console.log("[JIBB] System state read failed:", e?.message || e);
		}
		await sleep(pollMs);
	}
	return false;
}


async function detectDeviceModeSimple(retries = 10, delayMs = 1000) {
	for (let i = 0; i < retries; i++) {
		const isMtr =
			await hasPath(() => xapi.Status.MicrosoftTeams.User.SignedIn.get(), "Teams.SignedIn") ||
			await hasPath(() => xapi.Status.MicrosoftTeams.Software.VersionCode.TeamsApp.get(), "TeamsApp");

		if (isMtr) return DEVICE_MODE.MTR;
		await sleep(delayMs);
	}
	return DEVICE_MODE.WEBEX;
}

async function waitForWebViewReady(expectedUrl, timeoutMs = 30000) {
	const start = Date.now();
	const base = String(expectedUrl || "").split("?")[0];

	while (Date.now() - start < timeoutMs) {
		const views = await safe(() => xapi.Status.UserInterface.WebView.get(), "Status.UserInterface.WebView.get()");
		const list = Array.isArray(views) ? views : (views ? [views] : []);

		// try to match your meeting URL, otherwise just take the first integration view
		const v =
			list.find(w => String(w?.URL || w?.Url || "").includes(base)) ||
			list.find(w => w?.Type === "Integration") ||
			list[0];

		if (v) {
			const statusOk = v.Status === "Visible";
			const httpOk = String(v.HttpResponseStatusCode) === "200";

			if (statusOk && httpOk) return true;
		}

		await sleep(500);
	}

	console.log("[JIBB] WebView not ready (Visible + 200) before timeout");
	return false;
}

async function waitForCallStackReady({ timeoutMs = 60000, pollMs = 1000 } = {}) {
	const start = Date.now();

	while (Date.now() - start < timeoutMs) {
		try {
			// Check Teams stack (MTR)
			const teamsPath = await hasPath(
				() => xapi.Status.MicrosoftTeams.Calling.InCall.get(),
				"Teams.Calling.InCall"
			);

			// Check Call stack (RoomOS)
			const calls = await safe(() => xapi.Status.Call.get(), "Status.Call.get()");
			const callStackReady = Array.isArray(calls);

			if (teamsPath || callStackReady) {
				console.log("[JIBB] Call stack ready");
				return true;
			}
		} catch { }

		console.log("[JIBB] Waiting for call stack...");
		await sleep(pollMs);
	}

	console.log("[JIBB] Call stack NOT ready before timeout");
	return false;
}


async function main() {

	await waitForSystemReady({ timeoutMs: 120000, pollMs: 1000 });

	await waitForCallStackReady({ timeoutMs: 90000 });

	deviceMode = await detectDeviceModeSimple(15, 1000);
	console.log("[JIBB] DeviceMode:", deviceMode);

	await addPanel(deviceMode);

	// safe to do these after system is up
	try {
		await xapi.Command.WebEngine.MediaAccess.add({
			Hostname: getHostname(config.webURL),
			Device: "Camera",
		});
	} catch (e) { }

	registerWebexCallHandlers();
	registerTeamsCallHandlers();

	reactToJibbClick();
	bindWidgetActions();
	showAlert();

	#mainBody#
}



main().catch(e => console.log("[JIBB] main crashed:", e?.message || e));


function reactToJibbClick() {

	xapi.Event.UserInterface.Extensions.Panel.Clicked.on(async (value) => {
		try {
			if (value.PanelId == "jibb_panel") {
				try {
					await getDeviceConfig()
					await checkSystemHealth("#ApiUrl#/health")
				} catch (err) {
					xapi.Command.UserInterface.Message.Alert.Display({
						Duration: 20,
						Text: "HttpClient, or JIBB API access. Please contact your device admin to check settings.",
						Title: "Essential device settings are missing",
					})
					hideJibbPanel()
					throw (err)
				}

				const state = await getMeetingState();
				if (state === MEETING_STATE.NONE) {
					console.log("No active meeting detected when JIBB clicked.");
				} else {
					console.log("Active meeting detected. State:", state);
				}



				await setCameraPreset(`Jibb${SessionDetails.selectedInput}`).catch(e =>
					console.log("[JIBB] setCameraPreset failed:", e?.message || e)
				);

				await showCameraSelfView()
			}

		} catch (e) {
			console.log("[JIBB] Panel.Clicked handler crashed:", e?.message || e);
		}
	})
}


function logIfRunning(...args) {
	if (SessionDetails.isJibbRunning) {
		console.log(...args);
	}
}

function stringReplace(oldStr, newStr) {
	uiExtension = uiExtension.replace(oldStr, newStr)
}


let uiExtension = `<Extensions>
  <Version>1.11</Version>
  <Panel>
       <Order>1</Order>
	   <PanelId>jibb_panel</PanelId>
	   <Location>#UILocation#</Location>
	   <Icon>Custom</Icon>
	   <Name>JIBB</Name>
	   <ActivityType>Custom</ActivityType>
    <CustomIcon>
		<Content>
		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
		</Content>
		<Id>923c419c5ca7abb5bd70a34f9752d287a8bd649e764633ed43c66237ef81f110</Id>
	</CustomIcon>
    <Page>
      <Name>JIBB</Name>
	  <Row>
        <Name>Row</Name>
        <Widget>
          <WidgetId>widget_3</WidgetId>
           <Name>JIBB makes handwriting collaborative, digitized, shareable</Name>
          <Type>Text</Type>
          <Options>size=4;fontSize=normal;align=center</Options>
        </Widget>       
      </Row>
    <Row>
        <Name>Row</Name>
        <Widget>
          <WidgetId>widget_5</WidgetId>
          <Name>Tap Start when you're ready to Launch JIBB Session</Name>
          <Type>Text</Type>
          <Options>size=4;fontSize=small;align=left</Options>
        </Widget>
      </Row>
      <Row>
        <Name>Row</Name>
        <Widget>
		<WidgetId>jibb_start_toggle</WidgetId>
		<Type>GroupButton</Type>
		<Options>size=4</Options>
		<ValueSpace>
			<Value>
			<Key>start</Key>
			<Name>Start</Name>
			</Value>
			<Value>
			<Key>stop</Key>
			<Name>Stop</Name>
			</Value>
		</ValueSpace>
		</Widget>
		</Row>
		<Options>hideRowNames=1</Options>
    </Page>
  </Panel>
</Extensions>`

#InputCode#

#EmailCode#

#CameraControlCode#
